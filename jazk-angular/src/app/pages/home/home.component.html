<!-- Hero Section - Home Page -->
<app-header (onSelectNote)="receiveNoteFromSearch($event)"></app-header>
<div class="page-wrapper">
  <div class="mb-3" *ngIf="fetching || deleting">
    <div class="progress">
      <div class="progress-bar progress-bar-indeterminate bg-green"></div>
    </div>
  </div>

  <div class="page-body" *ngIf="!fetching">
    <div class="container-xl">
      <div class="">
        <div class="row justify-content-center">
          <div class="col-sm-12 col-lg-3">
            <app-side-menu></app-side-menu>
          </div>
          <div class="col-sm-12 col-lg-9">
            <div class="row row-deck row-cards">
              <div class="col-sm-6 col-lg-6">
                <div class="card">
                  <div class="card-body">
                    <div class="d-flex align-items-center">
                      <div class="subheader">No of Quotations Generated</div>
                    </div>
                    <div class="h1 mb-3">{{ quotationCount }}</div>

                    <div class="progress progress-sm">
                      <div
                        class="progress-bar bg-primary"
                        style="width: 75%"
                        role="progressbar"
                        aria-valuenow="75"
                        aria-valuemin="0"
                        aria-valuemax="100"
                        aria-label="75% Complete"
                      >
                        <span class="visually-hidden">75% Complete</span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-sm-6 col-lg-6">
                <div class="card">
                  <div class="card-body">
                    <div class="d-flex align-items-center">
                      <div class="subheader">No of Policies Sold</div>
                    </div>
                    <div class="d-flex align-items-baseline">
                      <div class="h1 mb-0 me-2">{{ salesCount }}</div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-sm-6 col-lg-6">
                <div class="card">
                  <div class="card-body">
                    <div class="d-flex align-items-center">
                      <div class="subheader">Gross Premium Sold</div>
                    </div>
                    <div class="d-flex align-items-baseline">
                      <div class="h1 mb-3 me-2">
                        Kshs {{ grossPremiumSold | number }}
                      </div>
                    </div>
                  </div>
                </div>
              </div>
              <div class="col-sm-6 col-lg-6">
                <div class="card">
                  <div class="card-body">
                    <div class="d-flex align-items-center">
                      <div class="subheader">Commissioned Earned</div>
                    </div>
                    <div class="d-flex align-items-baseline">
                      <div class="h1 mb-3 me-2">
                        Kshs {{ commissionEarned | number }}
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <div
              class="mb-3 mt-3"
              *ngIf="
                parseService.fetching ||
                parseService.saving ||
                parseService.deleting
              "
            >
              <div class="progress">
                <div
                  class="progress-bar progress-bar-indeterminate bg-green"
                ></div>
              </div>
            </div>
            <br />
            <div class="card">
              <div class="card-header">
                <ul
                  class="nav nav-tabs card-header-tabs"
                  data-bs-toggle="tabs"
                  role="tablist"
                >
                  <li class="nav-item" role="presentation">
                    <a
                      href="#tabs-quotations"
                      class="nav-link active"
                      data-bs-toggle="tab"
                      aria-selected="true"
                      role="tab"
                    >
                    <svg  xmlns="http://www.w3.org/2000/svg"  width="24"  height="24"  viewBox="0 0 24 24"  fill="none"  stroke="currentColor"  stroke-width="2"  stroke-linecap="round"  stroke-linejoin="round"  class="icon icon-tabler icons-tabler-outline icon-tabler-smart-home"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M19 8.71l-5.333 -4.148a2.666 2.666 0 0 0 -3.274 0l-5.334 4.148a2.665 2.665 0 0 0 -1.029 2.105v7.2a2 2 0 0 0 2 2h12a2 2 0 0 0 2 -2v-7.2c0 -.823 -.38 -1.6 -1.03 -2.105" /><path d="M16 15c-2.21 1.333 -5.792 1.333 -8 0" /></svg>
                      <strong>Your Recent Quotes</strong>
                    </a>
                  </li>

                  <li class="nav-item" role="presentation">
                    <a
                      href="#tabs-sales"
                      class="nav-link"
                      data-bs-toggle="tab"
                      aria-selected="false"
                      tabindex="-1"
                      role="tab"
                    >
                      <svg
                        xmlns="http://www.w3.org/2000/svg"
                        width="24"
                        height="24"
                        viewBox="0 0 24 24"
                        fill="none"
                        stroke="currentColor"
                        stroke-width="2"
                        stroke-linecap="round"
                        stroke-linejoin="round"
                        class="icon"
                      >
                        <path stroke="none" d="M0 0h24v24H0z" fill="none" />
                        <path
                          d="M9 5h-2a2 2 0 0 0 -2 2v12a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-12a2 2 0 0 0 -2 -2h-2"
                        />
                        <path
                          d="M9 3m0 2a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v0a2 2 0 0 1 -2 2h-2a2 2 0 0 1 -2 -2z"
                        />
                        <path d="M9 17v-5" />
                        <path d="M12 17v-1" />
                        <path d="M15 17v-3" />
                      </svg>

                      <strong>Your Recent Sales</strong>
                    </a>
                  </li>
                </ul>
              </div>
              <div class="card-body">
                <div class="tab-content">
                  <div
                    class="tab-pane active show"
                    id="tabs-quotations"
                    role="tabpanel"
                  >
                    <div class="card">
                      <div class="">
                        <table class="table table-vcenter card-table">
                          <thead>
                            <tr>
                              <th>No.</th>
                              <th>Date</th>
                              <th>Client</th>
                              <th>What is Insured</th>
                              <th class="w-1"></th>
                            </tr>
                          </thead>
                          <tbody>
                            <tr *ngFor="let item of quotations; let i = index">
                              <td class="text-primary">
                                {{ i + 1 }}
                              </td>
                              <td>
                                {{ item.get("createdAt") | date }}
                              </td>

                              <td class="text-secondary">
                                {{ item.get("client").name }}
                              </td>
                              <td class="text-secondary">
                                <strong style="color: orange">{{
                                  item.get("whatIsInsured")
                                }}</strong>
                              </td>

                              <td class="text-end">
                                <span class="dropdown">
                                  <button
                                    class="btn dropdown-toggle align-text-top"
                                    data-bs-boundary="viewport"
                                    data-bs-toggle="dropdown"
                                  >
                                    Actions
                                  </button>
                                  <div class="dropdown-menu dropdown-menu-end">
                                    <a
                                      [routerLink]="['/motor-view-quote', item.id]"
                                      routerLinkActive="router-link-active"
                                      class="dropdown-item text-green"
                                    >
                                      View
                                    </a>
                                    <a
                                      routerLinkActive="router-link-active"
                                      class="dropdown-item text-green"
                                    >
                                      Sale
                                    </a>

                                    <!-- <a [hidden]="item.get('status') == 'Completed'" *ngIf="auth.isAdmin"
                                    (click)="deleteItem(item)"
                                    class="dropdown-item text-red"
                                  >
                                    Delete
                                  </a> -->
                                  </div>
                                </span>
                              </td>
                            </tr>
                          </tbody>
                        </table>

                        <div
                          class="card card-md"
                          *ngIf="quotations?.length == 0"
                        >
                          <div class="card-body">
                            <p class="text-secondary mb-4">Nothing found</p>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="tab-pane" id="tabs-sales" role="tabpanel">
                    <div class="card">
                      <div class="">
                        <table class="table table-vcenter card-table">
                          <thead>
                            <tr>
                              <th>No.</th>
                              <th>Date</th>
                              <th>Client</th>
                              <th>What is Insured</th>
                              <th>Premium</th>
                              <th>Payment Status</th>
                              <th class="w-1"></th>
                            </tr>
                          </thead>
                          <tbody>
                            <tr *ngFor="let item of sales; let i = index">
                              <td class="text-primary">
                                {{ i + 1 }}
                              </td>
                              <td>
                                {{ item.get("createdAt") | date }}
                              </td>

                              <td class="text-secondary">
                                {{ item.get("client").name }}
                              </td>
                              <td class="text-secondary">
                                <strong style="color: orange">{{
                                  item.get("whatIsInsured")
                                }}</strong>
                              </td>
                              <td class="text-success">
                                {{ item.get("premium") || "---" }}
                              </td>
                              <td class="text-azure">
                                {{ item.get("paymentStatus") || "Not Paid" }}
                              </td>

                              <td class="text-end">
                                <span class="dropdown">
                                  <button
                                    class="btn dropdown-toggle align-text-top"
                                    data-bs-boundary="viewport"
                                    data-bs-toggle="dropdown"
                                  >
                                    Actions
                                  </button>
                                  <div class="dropdown-menu dropdown-menu-end">
                                    <a
                                      routerLinkActive="router-link-active"
                                      class="dropdown-item text-green"
                                    >
                                      View
                                    </a>
                                    <a
                                      routerLinkActive="router-link-active"
                                      class="dropdown-item text-green"
                                    >
                                      Sale
                                    </a>

                                    <!-- <a [hidden]="item.get('status') == 'Completed'" *ngIf="auth.isAdmin"
                                    (click)="deleteItem(item)"
                                    class="dropdown-item text-red"
                                  >
                                    Delete
                                  </a> -->
                                  </div>
                                </span>
                              </td>
                            </tr>
                          </tbody>
                        </table>

                        <div class="card card-md" *ngIf="sales?.length == 0">
                          <div class="card-body">
                            <p class="text-secondary mb-4">Nothing found</p>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
